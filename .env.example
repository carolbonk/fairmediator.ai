# MongoDB Configuration
# For local development with Docker (with authentication):
MONGODB_URI=mongodb://admin:changeme_production@localhost:27017/fairmediator?authSource=admin
# Or use MongoDB Atlas (recommended for production):
# MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/fairmediator

# Docker MongoDB Credentials (must match docker-compose.yml)
MONGO_ROOT_USER=admin
MONGO_ROOT_PASSWORD=changeme_production
MONGO_EXPRESS_USER=admin
MONGO_EXPRESS_PASSWORD=changeme_express

# Server Configuration
PORT=5000
NODE_ENV=development

# Llama API Configuration
# Choose your provider: Together AI, Groq, Fireworks AI, or self-hosted
LLAMA_API_KEY=your_api_key_here
LLAMA_API_BASE_URL=https://api.together.xyz/v1
# Recommended models:
# - meta-llama/Llama-3.3-70B-Instruct (best quality)
# - meta-llama/Llama-3.1-8B-Instruct (faster, cheaper)
LLAMA_MODEL=meta-llama/Llama-3.3-70B-Instruct

# Llama Settings
LLAMA_TEMPERATURE=0.7
LLAMA_MAX_TOKENS=2048

# Web Scraping (Optional - for LinkedIn integration)
LINKEDIN_EMAIL=your_email@example.com
LINKEDIN_PASSWORD=your_password

# Security (CRITICAL: Generate strong random secrets for production!)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_SECRET=your_jwt_secret_key_here_min_32_chars
JWT_REFRESH_SECRET=your_jwt_refresh_secret_key_here_min_32_chars
SESSION_SECRET=your_session_secret_here_min_32_chars

# CORS
CORS_ORIGIN=http://localhost:3000

# ===================================
# Rate Limiting (General API Protection)
# ===================================
# This protects your API endpoints from abuse (e.g., DDoS)
RATE_LIMIT_WINDOW_MS=900000        # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100        # Max requests per window

# ===================================
# Free Tier Protection (Service-Specific)
# ===================================
# CRITICAL: These limits prevent exhausting free tiers before month end
# Daily limits calculated as: (monthly_limit / 30) Ã— safety_factor

# Redis/Upstash Free Tier: 10k commands/day, 300k/month
REDIS_DAILY_LIMIT=1250            # Conservative: ~40% of daily allowance
REDIS_MONTHLY_LIMIT=300000

# Hugging Face API (varies by model)
HUGGINGFACE_DAILY_LIMIT=333       # 1/3 of monthly limit (10k/30 days)
HUGGINGFACE_MONTHLY_LIMIT=10000   # 1/3 of free tier (30k/3)

# MongoDB Atlas Free Tier: 512MB storage
MONGODB_SIZE_LIMIT=536870912      # 512MB in bytes

# Weaviate Cloud Free Tier: 100k vectors
WEAVIATE_VECTOR_LIMIT=100000

# Resend Email Free Tier: 100/day, 3000/month
RESEND_DAILY_LIMIT=90             # Stay under 100/day
RESEND_MONTHLY_LIMIT=3000


# Web Scraping: Respect robots.txt + rate limits
SCRAPING_DAILY_LIMIT=450          # ~500/day max
SCRAPING_MONTHLY_LIMIT=15000

# Alert Thresholds (0.0 - 1.0)
FREE_TIER_WARNING_THRESHOLD=0.70   # 70% - Warning log
FREE_TIER_ALERT_THRESHOLD=0.85     # 85% - Alert + slow down
FREE_TIER_CRITICAL_THRESHOLD=0.95  # 95% - Graceful degradation
FREE_TIER_STOP_THRESHOLD=1.0       # 100% - Stop operations

# Feature Flags
ENABLE_AFFILIATION_DETECTION=true
ENABLE_IDEOLOGY_CLASSIFICATION=true
ENABLE_REAL_TIME_SCRAPING=false
